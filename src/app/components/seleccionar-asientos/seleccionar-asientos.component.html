<app-loader></app-loader>
<app-header></app-header>
<section class="asientos">
    <div class="semiconta mt-5">
        <app-progress [style]="'width:50%'"></app-progress>
        <div class="row pt-5">
            <div class="col-12 mb-4">
                <div class="alert alert-primary btn-oro no-margin" role="alert">
                    <div class="row">
                        <div class="col align-self-start">
                            <h6 class="no-margin fw-bold">Tiempo restante:</h6>
                        </div>
                        <div class="col align-self-end text-end">
                            <h6 class="no-margin fw-bold"> {{local.minutos}}: {{local.segundos}}</h6>
                        </div>
                    </div>
                </div>
            </div>
            <div class="elpadding col-md-12 col-lg-12 col-xl-6 col-xxl-6">
                <div class="row">
                    <div class="card p-3 mb-2 border-0 bg-light rounded-9 shadow">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex flex-row align-items-center">
                                <div class="ms-2 c-details no-margin">
                                    <img [src]="local.miviajeida.EmpresaLogoURL" class="img-fluid w-25"
                                        alt="Autobuses Oro">
                                        <br>
                                <img *ngIf="local.miviajeida.Servicio=='PLUS'" src="/assets/img/servicio-plus.png" class="img-plus" alt="Autobuses Oro">
                                <img *ngIf="local.miviajeida.Servicio=='PRIMERA CLASE'" src="/assets/img/servicio-primera.png" class="img-tipo" alt="Autobuses Oro">
                                <img *ngIf="local.miviajeida.Servicio=='SUPERTURISMO'" src="/assets/img/servicio-super.png" class="img-tipo" alt="Autobuses Oro">
                                <h4 *ngIf="local.miviajeida.Servicio=='SEMIDIRECTO'" class="fw-bold fst-italic mt-2">{{local.miviajeida.Servicio}}</h4>
                                </div>
                            </div>
                        </div>
                        <div class="row d-flex align-items-center">
                            <div class="col-4 ps-4">
                                <h4 class="fw-bold no-margin">{{local.miviajeida.HoraViajePtoInt | date:'H:mm'}} h</h4>
                                <h5 class="small text-muted fst-italic">SALIDA {{local.miviajeida.OrigenNombre}}</h5>
                            </div>
                            <div class="col-4 text-center">
                                <i class="fa-solid fa-bus-simple"></i>
                                <div class="mb-3 oro-border-travel"></div>
                            </div>
                            <div class="col-4 ps-4">
                                <h4 class="fw-bold no-margin">{{local.miviajeida.Horallegada| date:'H:mm'}} h</h4>
                                <h5 class="small text-muted fst-italic">LLEGADA {{local.miviajeida.DestinoNombre}}</h5>
                            </div>
                        </div>

                        <div class="row w-100">

                            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6 ">
                                <form [formGroup]="formabordo">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Lugar de Abordaje</mat-label>
                                        <mat-select  matNativeControl formControlName="miabordaje">
                                            <mat-option *ngFor="let item of abordajes;let i = index;" [value]="i">
                                                {{item.DestinoNombre}}</mat-option>
                                        </mat-select >
                                        <mat-error *ngIf="miabordaje.invalid && miabordaje.touched">
                                            <strong>campo requerido</strong>
                                        </mat-error>
                                    </mat-form-field>
                                </form>
                            </div>
                        </div>
                        <div class="col-12">
                            <h6 class=" small fw-bold mt-1">Tiempo de recorrido aproximado y depende de las condiciones
                                del clima y tráfico</h6>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-md-12 col-lg-12 col-xl-6 col-xxl-6">
                <div class="row p-3 border-0 bg-light rounded-9 shadow">
                    <h4 class="fw-bold">Selecciona tu asiento {{modoviaje}}</h4>
                    <app-autobus *ngIf="abordajes.length>=1" [Asientos]="Asientos" [Viaje]="Nfilas"
                        [cantidad]="cantidad" [Empresa]="empresa" [events]="events" [ocupado]="ocupado"
                        (eleccion)="siguiente($event)"></app-autobus>
                </div>
                <h4 class="fw-bold pt-3">Asiento seleccionado(s)</h4>
                <div [formGroup]="form">
                    <div class="border-0 bg-light rounded-9 shadow row mt-3 mat-typography" formArrayName="pasajeros"
                        *ngFor="let o of pasajeros.controls; let i = index">
                        <div class="row" [formGroupName]="i">
                            <div class="col-12">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <h3 class="fw-bold">Pasajero {{i+1}}</h3>
                                        <img *ngIf="local.miviajeida.EmpresaNombre=='ORO'" class="imgasiento"
                                            src="/assets/icon/select-oro.png">
                                        <img *ngIf="local.miviajeida.EmpresaNombre=='ERCO'" class="imgasiento"
                                            src="/assets/icon/select-erco.png">
                                        <img *ngIf="local.miviajeida.EmpresaNombre =='SURIANOS'" class="imgasiento"
                                            src="/assets/icon/select-surianos.png">
                                        <h3 class="fw-bold solotu">Asiento: {{pasajes[i].Asiento}}</h3>
                                    </div>
                                    <div class="col-sm-9 p-2">
                                        <div class="row">
                                            <div class="col-sm-6">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Nombre(s)</mat-label>
                                                    <input matInput name="firstName" id="firstName"
                                                        placeholder="Nombre(s)" formControlName="ClienteNombre">
                                                        <mat-error *ngIf="pasajeros.controls[i].parent?.invalid">No están permitidos
                                                            <strong>caracteres especiales</strong></mat-error>
                                                </mat-form-field>
                                            </div>
                                            <div class="col-sm-6">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Apellido(s)</mat-label>
                                                    <input matInput name="lastName" id="lastName"
                                                        placeholder="Apellido(s)" formControlName="Apellido">
                                                        <mat-error *ngIf="pasajeros.controls[i].parent?.invalid">No están permitidos
                                                            <strong>caracteres especiales</strong></mat-error>
                                                </mat-form-field>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                <div class="row align-items-center">
                                    <div class="col-sm-12 col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                        <h3>Tipo de Boleto</h3>
                                    </div>
                                    <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6 col-xxl-6">
                                        <mat-form-field appearance="outline" class="no-margin">
                                            <mat-label>BOLETO</mat-label>
                                            <mat-select matNativeControl (selectionChange)="precioselect($event,i)"
                                                formControlName="myindex">
                                                <mat-option *ngFor="let item of precios; let n = index" [value]="n"[disabled]="i==0 && item.Descuento=='D5' && cantidad>=1">
                                                    {{item.DescuentoDsc}}</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div *ngIf="misprecios[i].precio!='0.00'" class="col-sm-6 col-md-2 col-lg-2 col-xl-2 col-xxl-2">
                                        <h2>{{misprecios[i].precio| currency}}</h2>
                                    </div>
                                </div>
                                <mat-error class="text-center" *ngIf="misprecios[i].tipo=='Insen'">
                                    <strong>* Es indispensable presentar credencial vigente de INAPAM para abordar</strong>
                                </mat-error>
                                <mat-error class="text-center" *ngIf="misprecios[i].tipo=='Niños'">
                                    <strong>* La edad y/o estatura máxima para el descuento es: 11 años y 1.3 m de Estatura</strong>
                                </mat-error>
                            </div>
                        </div>
                    </div>
                </div>
                <div class=" mt-3 col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-3 col-xxl-3">
                    <button
                        [disabled]="this.form.controls['pasajeros'].invalid || this.form.controls['pasajeros'].value.length< cantidad "
                        class="btn btn-oro btn-lg rounded-pill w-100" (click)="continuar()">
                        Continuar
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>
<app-footer></app-footer>